---
import Layout from '@/layouts/Layout.astro';
import CountrySelect from '@/components/CountrySelect.astro';
import PhoneCodeSelect from '@/components/PhoneCodeSelect.astro';
import { useTranslations } from '@/i18n/utils';
import GoogleReviews from '@/components/GoogleReviews.astro';
import Services from '@/components/Services.astro';

export async function getStaticPaths() {
  return [
    { params: { lang: 'en' } },
    { params: { lang: 'es' } }
  ];
}

const { lang } = Astro.params as { lang: "en" | "es" };
const t = useTranslations(lang);

const pageTitle = lang === 'en' 
  ? "Pricing - 7-Day All-Inclusive Retreat | Casa del Jaguar"
  : "Precios - Retiro de 7 Días Todo Incluido | Casa del Jaguar";

const pageDescription = lang === 'en'
  ? "Experience deep transformation with our 7-day all-inclusive ancestral medicine retreat. Starting at $4,900 USD including ceremonies, luxury accommodation and wellness practices."
  : "Experimenta una transformación profunda con nuestro retiro de medicina ancestral de 7 días todo incluido. Desde $4,900 USD incluye ceremonias, alojamiento de lujo y prácticas de bienestar.";

const pageKeywords = lang === 'en'
  ? "Casa del Jaguar pricing, ayahuasca retreat cost, ancestral medicine price, 7-day retreat Iquitos, book spiritual retreat"
  : "precios Casa del Jaguar, retiro ayahuasca costo, medicina ancestral precio, retiro 7 días Iquitos, reservar retiro espiritual";
---

<Layout 
  title={pageTitle}
  description={pageDescription}
  keywords={pageKeywords}
>
  <section class="hero relative h-[500px] -mt-16 pt-16 flex items-center justify-center overflow-hidden">
    <div class="absolute inset-0 z-0">
      <img 
        src="/img/centro-pasadiso.webp" 
        alt={lang === 'en' ? "Casa del Jaguar - Ancestral medicine retreat" : "Casa del Jaguar - Retiro de medicina ancestral"}
        class="w-full h-full object-cover"
      />
    </div>

    <div class="relative z-10 max-w-6xl mx-auto px-4 md:px-8 text-center">
      <h1 class="scroll-animate text-4xl md:text-6xl font-bold text-white font-georgia mb-8 leading-tight">
        {lang === 'en' 
          ? <>7-Day All-Inclusive Experience<br><span class="text-brand-primary">Starting at $2,800 USD</span></>
          : <>Experiencia de 7 Días Todo Incluido<br><span class="text-brand-primary">Desde $2,800 USD</span></>
        }
      </h1>
      
      <p class="scroll-animate text-xl md:text-[19px] text-white mb-12 max-w-4xl mx-auto font-gotham leading-relaxed">
        {lang === 'en' 
          ? "An investment in your personal transformation that includes ancestral medicine ceremonies, wellness practices, and luxury accommodation in the heart of the Amazon."
          : "Una inversión en tu transformación personal que incluye ceremonias de medicina ancestral, prácticas de bienestar y alojamiento de lujo en el corazón de la Amazonía."
        }
      </p>
    </div>
  </section>

  <section class="py-20 bg-white scroll-animate">
    <div class="max-w-7xl mx-auto px-4 md:px-8">
      <div class="grid lg:grid-cols-2 gap-16 items-start">
        <div class="space-y-8">
          <div class="scroll-animate">
            <h2 class="text-4xl md:text-5xl font-bold text-brand-dark font-georgia mb-6">
              {lang === 'en' ? "Your Transformation Journey Includes" : "Tu Viaje de Transformación Incluye"}
            </h2>
            <p class="text-lg text-brand-dark font-gotham leading-relaxed mb-8">
              {lang === 'en' 
                ? "Our 7-day retreat is carefully designed to offer you a complete experience of healing and personal growth in an environment of luxury and safety."
                : "Nuestro retiro de 7 días está cuidadosamente diseñado para ofrecerte una experiencia completa de sanación y crecimiento personal en un entorno de lujo y seguridad."
              }
            </p>
          </div>

          <div class="border-l-4 border-brand-primary pl-6 scroll-animate">
            <p class="text-sm text-gray-600 font-gotham leading-relaxed mb-2">
              <strong>{lang === 'en' ? "Pricing note:" : "Nota sobre precios:"}</strong> 
              {lang === 'en' 
                ? " Final pricing may vary based on room selection and additional services. Premium rooms and suites have an additional cost."
                : " El precio final puede variar según la selección de habitación y servicios adicionales. Las habitaciones premium y suites tienen un costo adicional."
              }
            </p>
          </div>
        </div>

        <div class="lg:sticky lg:top-8">
          <div class="bg-white shadow-2xl rounded-2xl p-8 border border-gray-100 scroll-animate">
            <h3 class="text-2xl font-bold text-brand-dark font-georgia mb-2">
              {lang === 'en' 
                ? "Book Your Free Information Session"
                : "Reserva tu Sesión Informativa Gratuita"
              }
            </h3>
            <p class="text-gray-600 font-gotham mb-6">
              {lang === 'en' 
                ? "Complete this form and we'll contact you to schedule a personalized consultation."
                : "Completa este formulario y nos pondremos en contacto contigo para programar una consulta personalizada."
              }
            </p>

            <form id="pricingForm" class="space-y-4">
              <div class="grid grid-cols-2 gap-4">
                <div>
                  <label for="firstName" class="block text-sm font-semibold text-brand-dark font-gotham mb-2">
                    {lang === 'en' ? "First Name *" : "Nombre *"}
                  </label>
                  <input 
                    type="text" 
                    id="firstName" 
                    name="firstName" 
                    required
                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-primary focus:border-transparent transition-colors font-gotham"
                    placeholder={lang === 'en' ? "Your first name" : "Tu nombre"}
                  />
                  <span class="error-message text-red-500 text-sm hidden">
                    {lang === 'en' ? "This field is required" : "Este campo es requerido"}
                  </span>
                </div>
                <div>
                  <label for="lastName" class="block text-sm font-semibold text-brand-dark font-gotham mb-2">
                    {lang === 'en' ? "Last Name *" : "Apellido *"}
                  </label>
                  <input 
                    type="text" 
                    id="lastName" 
                    name="lastName" 
                    required
                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-primary focus:border-transparent transition-colors font-gotham"
                    placeholder={lang === 'en' ? "Your last name" : "Tu apellido"}
                  />
                  <span class="error-message text-red-500 text-sm hidden">
                    {lang === 'en' ? "This field is required" : "Este campo es requerido"}
                  </span>
                </div>
              </div>

              <div>
                <label for="email" class="block text-sm font-semibold text-brand-dark font-gotham mb-2">
                  Email *
                </label>
                <input 
                  type="email" 
                  id="email" 
                  name="email" 
                  required
                  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-primary focus:border-transparent transition-colors font-gotham"
                  placeholder={lang === 'en' ? "your@email.com" : "tu@email.com"}
                />
                <span class="error-message text-red-500 text-sm hidden">
                  {lang === 'en' ? "Please enter a valid email" : "Por favor ingresa un email válido"}
                </span>
              </div>

              <div>
                <label for="country" class="block text-sm font-semibold text-brand-dark font-gotham mb-2">
                  {lang === 'en' ? "Country *" : "País *"}
                </label>
                <CountrySelect 
                  id="country" 
                  name="country" 
                  required={true}
                  lang={lang}
                />
                <span class="error-message text-red-500 text-sm hidden">
                  {lang === 'en' ? "Please select your country" : "Por favor selecciona tu país"}
                </span>
              </div>

              <div class="grid grid-cols-2 gap-4 scroll-animate">
                <div>
                  <label for="phoneCode" class="block text-sm font-semibold text-brand-dark font-gotham mb-2">
                    {lang === 'en' ? "Country Code *" : "Código de País *"}
                  </label>
                  <PhoneCodeSelect 
                    id="phoneCode" 
                    name="phoneCode" 
                    required={true}
                    lang={lang}
                  />
                  <span class="error-message text-red-500 text-sm hidden">
                    {lang === 'en' ? "Please select your country code" : "Por favor selecciona tu código de país"}
                  </span>
                </div>
                <div>
                  <label for="phone" class="block text-sm font-semibold text-brand-dark font-gotham mb-2">
                    {lang === 'en' ? "Phone *" : "Teléfono *"}
                  </label>
                  <input 
                    type="tel" 
                    id="phone" 
                    name="phone"
                    required
                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-primary focus:border-transparent transition-colors font-gotham"
                    placeholder={lang === 'en' ? "123-4567" : "123-4567"}
                  />
                  <span class="error-message text-red-500 text-sm hidden">
                    {lang === 'en' ? "This field is required" : "Este campo es requerido"}
                  </span>
                </div>
              </div>

              <button 
                type="submit" 
                class="w-full bg-brand-dark text-white py-4 px-6 rounded-lg font-semibold font-gotham text-lg transition-all duration-300 hover:bg-opacity-90 hover:shadow-lg focus:ring-2 focus:ring-brand-primary focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed"
                id="submitButton"
                aria-label={lang === 'en' ? "Submit pricing request form" : "Enviar formulario de solicitud de precios"}
              >
                {lang === 'en' ? "Submit Request" : "Enviar Solicitud"}
              </button>
            </form>

            <div id="successMessage" class="hidden mt-6 p-4 bg-green-50 border border-green-200 rounded-lg">
              <div class="flex items-center">
                <div class="w-6 h-6 bg-green-500 rounded-full flex items-center justify-center mr-3">
                  <svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                  </svg>
                </div>
                <div>
                  <h4 class="font-semibold text-green-800 font-gotham">
                    {lang === 'en' ? "Thank you for your interest!" : "¡Gracias por tu interés!"}
                  </h4>
                  <p class="text-green-700 font-gotham text-sm">
                    {lang === 'en' 
                      ? "We'll contact you soon to schedule your free information session."
                      : "Nos pondremos en contacto contigo pronto para programar tu sesión informativa gratuita."
                    }
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="py-16 bg-[#fffcf6] scroll-animate">
    <div class="max-w-7xl mx-auto px-4 md:px-8">
      <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-8">
        <div class="text-center">
          <div class="w-12 h-12 bg-[#D99D55] rounded-full flex items-center justify-center mx-auto mb-4">
            <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
            </svg>
          </div>
          <p class="text-brand-dark font-gotham text-sm leading-relaxed">
            {lang === 'en' 
              ? "Over 98% of our guests report a monumental transformation they describe as a \"miracle\"."
              : "Más del 98% de nuestros huéspedes reportan una transformación monumental que describen como un \"milagro\"."
            }
          </p>
        </div>

        <div class="text-center">
          <div class="w-12 h-12 bg-[#D99D55] rounded-full flex items-center justify-center mx-auto mb-4">
            <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
            </svg>
          </div>
          <p class="text-brand-dark font-gotham text-sm leading-relaxed">
            {lang === 'en' 
              ? "Experience ayahuasca safely in the only medically licensed plant medicine resort in the world."
              : "Experimenta ayahuasca de forma segura en el único resort de medicina vegetal con licencia médica en el mundo."
            }
          </p>
        </div>

        <div class="text-center">
          <div class="w-12 h-12 bg-[#D99D55] rounded-full flex items-center justify-center mx-auto mb-4">
            <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
            </svg>
          </div>
          <p class="text-brand-dark font-gotham text-sm leading-relaxed">
            {lang === 'en' 
              ? "Integrate and understand your experiences with ayahuasca in daily classes with thought leaders."
              : "Integra y comprende tus experiencias con ayahuasca en clases diarias con líderes de pensamiento."
            }
          </p>
        </div>

        <div class="text-center scroll-animate">
          <div class="w-12 h-12 bg-[#D99D55] rounded-full flex items-center justify-center mx-auto mb-4">
            <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
            </svg>
          </div>
          <p class="text-brand-dark font-gotham text-sm leading-relaxed">
            {lang === 'en' 
              ? "Visit the indigenous communities located in Iquitos."
              : "Visita las comunidades indígenas ubicadas en Iquitos."
            }
          </p>
        </div>
      </div>
    </div>
  </section>

  <section class="py-20 bg-white">
    <div class="max-w-[1500px] mx-auto px-4 md:px-8">
      <div class="text-center mb-16 scroll-animate">
        <h2 class="max-w-[1200px] mx-auto text-4xl md:text-5xl font-bold text-brand-dark font-georgia mb-6">
          {lang === 'en' ? "Transform Your Life With the Casa del Jaguar Way – a Highly Effective Program Fusing Ayahuasca Ceremonies and Modern Psychology" : "Por Qué Elegir Casa del Jaguar"}
        </h2>
      </div>

      <div class="grid md:grid-cols-3 gap-8 md:gap-10 scroll-animate">
        <div class="text-center group">
          <div class="w-16 h-16 mx-auto mb-6 text-[#F2AB27]">
            <svg fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 0 0 6 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 0 1 6 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 0 1 6-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0 1 18 18a8.967 8.967 0 0 0-6 2.292m0-14.25v14.25" />
            </svg>
          </div>
          <h3 class="text-xl font-bold text-brand-dark font-georgia mb-4">
            {lang === 'en' ? "Integration Support" : "Apoyo de Integración"}
          </h3>
          <p class="text-gray-600 font-gotham leading-relaxed">
            {lang === 'en' 
              ? "Daily classes with expert facilitators help you process and integrate your experiences deeply and meaningfully. You receive practical tools to bring transformation into your daily life."
              : "Clases diarias con facilitadores expertos te ayudan a procesar y integrar tus experiencias de manera profunda y significativa. Recibes herramientas prácticas para llevar la transformación a tu vida cotidiana."
            }
          </p>
        </div>

        <div class="text-center group scroll-animate">
          <div class="w-16 h-16 mx-auto mb-6 text-[#F2AB27]">
            <svg fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75 11.25 15 15 9.75m-3-7.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.623 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285Z" />
            </svg>
          </div>
          <h3 class="text-xl font-bold text-brand-dark font-georgia mb-4">
            {lang === 'en' ? "Medical Safety" : "Seguridad Médica"}
          </h3>
          <p class="text-gray-600 font-gotham leading-relaxed">
            {lang === 'en' 
              ? "We are the only fully medically licensed plant medicine resort in the world. Our professional medical team ensures your safety throughout the entire experience."
              : "Somos el único resort de medicina vegetal con licencia médica completa en el mundo. Nuestro equipo médico profesional garantiza tu seguridad durante toda la experiencia."
            }
          </p>
        </div>

        <div class="text-center group scroll-animate">
          <div class="w-16 h-16 mx-auto mb-6 text-[#F2AB27]">
            <svg fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 21v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21m0 0h4.5V3.545M12.75 21h7.5V10.75M2.25 21h1.5m18 0h-18M2.25 9l4.5-1.636M18.75 3l-1.5.545m0 6.205 3 1m1.5.5-1.5-.5M6.75 7.364V3h-3v18m3-13.636 10.5-3.819" />
            </svg>
          </div>
          <h3 class="text-xl font-bold text-brand-dark font-georgia mb-4">
            {lang === 'en' ? "Luxury Amenities" : "Comodidades de Lujo"}
          </h3>
          <p class="text-gray-600 font-gotham leading-relaxed">
            {lang === 'en' 
              ? "Enjoy elegant rooms, gourmet cuisine, and wellness spaces designed for your comfort. Your transformation unfolds in an environment of complete luxury and tranquility."
              : "Disfruta de habitaciones elegantes, gastronomía gourmet y espacios de bienestar diseñados para tu comodidad. Tu transformación se desarrolla en un ambiente de total lujo y tranquilidad."
            }
          </p>
        </div>

        <div class="text-center group scroll-animate">
          <div class="w-16 h-16 mx-auto mb-6 text-[#F2AB27]">
            <svg fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" d="M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z" />
            </svg>
          </div>
          <h3 class="text-xl font-bold text-brand-dark font-georgia mb-4">
            {lang === 'en' ? "Cultural Connection" : "Conexión Cultural"}
          </h3>
          <p class="text-gray-600 font-gotham leading-relaxed">
            {lang === 'en' 
              ? "Experience authentic ceremonies led by respected indigenous shamans. Connect with ancestral traditions and visit local communities for a deep cultural experience."
              : "Experimenta ceremonias auténticas dirigidas por chamanes indígenas respetados. Conecta con las tradiciones ancestrales y visita comunidades locales para una experiencia cultural profunda."
            }
          </p>
        </div>

        <div class="text-center group scroll-animate">
          <div class="w-16 h-16 mx-auto mb-6 text-[#F2AB27]">
            <svg fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z" />
            </svg>
          </div>
          <h3 class="text-xl font-bold text-brand-dark font-georgia mb-4">
            {lang === 'en' ? "Holistic Wellness" : "Bienestar Holístico"}
          </h3>
          <p class="text-gray-600 font-gotham leading-relaxed">
            {lang === 'en' 
              ? "Yoga, meditation, spa therapies, and wellness activities complement your healing journey. Every element is designed to nourish your body, mind, and spirit holistically."
              : "Yoga, meditación, terapias de spa y actividades de bienestar complementan tu viaje de sanación. Cada elemento está diseñado para nutrir tu cuerpo, mente y espíritu de manera integral."
            }
          </p>
        </div>

        <div class="text-center group scroll-animate">
          <div class="w-16 h-16 mx-auto mb-6 text-[#F2AB27]">
            <svg fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z" />
            </svg>
          </div>
          <h3 class="text-xl font-bold text-brand-dark font-georgia mb-4">
            {lang === 'en' ? "Personalized Experience" : "Experiencia Personalizada"}
          </h3>
          <p class="text-gray-600 font-gotham leading-relaxed">
            {lang === 'en' 
              ? "Small groups and individual attention ensure you receive the personalized support you need. Each guest is unique and your experience is tailored to your specific needs."
              : "Grupos pequeños y atención individual garantizan que recibas el apoyo personalizado que necesitas. Cada huésped es único y tu experiencia se adapta a tus necesidades específicas."
            }
          </p>
        </div>
      </div>
    </div>
  </section>

  <section class="py-20 bg-white scroll-animate">
      <div class="max-w-7xl mx-auto px-4 md:px-8">
        <GoogleReviews 
          title="Embrace Miracles - Join Casa del Jaguar's 97%"
          reviews={[
            {
              id: "1",
              name: "Candy Beatriz Rios Cahuaza",
              avatar: "/img/avatars/candy-beatriz-rios-cahuaza.webp",
              rating: 5,
              date: "6 months ago",
              text: "The experience at Casa del Jaguar is absolutely unmissable. From the very beginning, the service is first-class, with a welcoming and harmonious atmosphere. The Ayahuasca ceremony is guided with deep knowledge and wisdom, providing a transformative experience. Every detail, from the preparation to the explanation, contributes to making this session a unique and unforgettable moment. Without a doubt, this is an experience I recommend to those seeking an authentic and meaningful connection.",
              location: "Peru"
            },
            {
              id: "2", 
              name: "Diego Reuch Borbor",
              avatar: "/img/avatars/diego-reuch-borbor.webp",
              rating: 5,
              date: "10 months ago",
              text: "The experience at Casa del Jaguar is absolutely unmissable. From the very beginning, the service is first-class, with a welcoming and harmonious atmosphere. The Ayahuasca ceremony is guided with deep knowledge and wisdom, providing a transformative experience. Every detail, from the preparation to the explanation, contributes to making this session a unique and unforgettable moment. Without a doubt, this is an experience I recommend to those seeking an authentic and meaningful connection.",
              location: "Peru"
            },
            {
              id: "3",
              name: "Samuel Ballantine",
              rating: 5,
              date: "4 months ago",
              text: "This is a place for people who truly want to heal. The shaman is truly dedicated he is. The kind of man who will sit and talk to you all day if you so desire it. He holds great insight and will be able to guide you through your ceremonies and help you understand what you are seeing and processing. Couldn’t recommend this place any more.",
              location: "Italy"
            },
            {
              id: "4",
              name: "Jacopo Foglia",
              rating: 5,
              date: "3 months ago",
              text: "The experience with the shaman Denis was truly amazing! I had already participated in an ayahuasca ceremony before, but this one was really interesting and intimate. He guided me and my friend on an indescribable inner journey, helping us with several hours of conversation before the ceremony, explaining his approach to medicine and how to manage the ceremony in its different stages. I will definitely participate in another one when I return to Iquitos.",
              location: "Italy"
            },
            {
              id: "5",
              name: "Felix Rios Teran",
              avatar: "/img/avatars/felix-rios-teran.webp",
              rating: 5,
              date: "1 year ago",
              text: "Master Denis, thank you so much for guiding me and healing me with your wisdom during my experience with Mother Ayahuasca, a transformative experience that opens doors to introspection and healing. I am deeply grateful for your care, professionalism, and dedication. I recommend you to any brother seeking healing and spiritual growth at CASA DEL JAGUAR.",
              location: "Peru"
            },
            {
              id: "6",
              name: "Stella Palomares",
              avatar: "/img/avatars/stella-palomares.webp",
              rating: 5,
              date: "1 year ago", 
              text: "A rewarding and wisdom-filled experience with the warm hospitality of Mr. Jaguar and his lovely family; we felt very comfortable and surrounded by beautiful energy. We were well guided under the power of Mother Ayahuasca.",
              location: "Mexico"
            },
            {
              id: "7",
              name: "Victor Alfonso Vazquez Zapata",
              avatar: "/img/avatars/victor-alfonso-vazquez-zapata.webp",
              rating: 5,
              date: "1 year ago", 
              text: "The best experience of my life. Everything is spectacularly calculated. Thank you, Denis. See you soon. Greetings from Aguascalientes, Mexico.",
              location: "Mexico"
            },
            {
              id: "8",
              name: "Clever Enrique",
              rating: 5,
              date: "4 months ago", 
              text: "A beautiful place and completely safe to enjoy this wonderful experience. 100% recommended!",
              location: "Italy"
            }
          ]}
          autoplay={true}
          autoplayDelay={7000}
        />
      </div>
    </section>

    <Services />

    <section class="py-20 bg-[#fffcf6] scroll-animate">
      <div class="max-w-[1500px] mx-auto px-4 md:px-8">
        <div class="text-center mb-16">
          <h2 class="text-4xl md:text-5xl font-bold text-brand-dark font-georgia mb-6">
            {lang === 'en' ? "Transform your Life at Casa del Jaguar" : "Testimonios en Video"}
          </h2>
        </div>

        <div class="relative">
          <div class="video-slider overflow-hidden">
            <div class="video-track sm:h-[350px] md:h-[400px] flex transition-transform duration-500 ease-in-out">
              <div class="video-slide flex-shrink-0 w-full md:w-1/2 lg:w-1/3 px-3">
                <div class="bg-white rounded-xl shadow-lg overflow-hidden group cursor-pointer video-thumbnail" 
                     data-video-id="dQw4w9WgXcQ" 
                     data-title={lang === 'en' ? "Transformational Experience - María González" : "Experiencia Transformadora - María González"}>
                  <div class="relative">
                    <img 
                      src="https://img.youtube.com/vi/dQw4w9WgXcQ/maxresdefault.jpg" 
                      alt={lang === 'en' ? "Testimony of María González" : "Testimonio de María González"} 
                      class="w-full h-48 object-cover group-hover:scale-105 transition-transform duration-300"
                    >
                    <div class="absolute inset-0 transition-all duration-300 flex items-center justify-center">
                      <div class="w-16 h-16 bg-white bg-opacity-90 rounded-full flex items-center justify-center group-hover:scale-110 transition-transform duration-300">
                        <svg class="w-6 h-6 text-brand-dark ml-1" fill="currentColor" viewBox="0 0 24 24">
                          <path d="M8 5v14l11-7z"/>
                        </svg>
                      </div>
                    </div>
                  </div>
                  <div class="p-6">
                    <h3 class="text-lg font-bold text-brand-dark font-georgia mb-2">
                      {lang === 'en' ? "Transformational Experience" : "Experiencia Transformadora"}
                    </h3>
                    <p class="text-gray-600 font-gotham text-sm">
                      {lang === 'en' 
                        ? "María González shares her healing experience at Casa del Jaguar"
                        : "María González comparte su experiencia de sanación en Casa del Jaguar"
                      }
                    </p>
                  </div>
                </div>
              </div>

              <div class="video-slide flex-shrink-0 w-full md:w-1/2 lg:w-1/3 px-3">
                <div class="bg-white rounded-xl shadow-lg overflow-hidden group cursor-pointer video-thumbnail" 
                     data-video-id="9bZkp7q19f0" 
                     data-title={lang === 'en' ? "A Journey of Self-Discovery - Carlos Mendoza" : "Un Viaje de Autodescubrimiento - Carlos Mendoza"}>
                  <div class="relative">
                    <img 
                      src="https://img.youtube.com/vi/9bZkp7q19f0/maxresdefault.jpg" 
                      alt={lang === 'en' ? "Testimony of Carlos Mendoza" : "Testimonio de Carlos Mendoza"} 
                      class="w-full h-48 object-cover group-hover:scale-105 transition-transform duration-300"
                    >
                    <div class="absolute inset-0 transition-all duration-300 flex items-center justify-center">
                      <div class="w-16 h-16 bg-white bg-opacity-90 rounded-full flex items-center justify-center group-hover:scale-110 transition-transform duration-300">
                        <svg class="w-6 h-6 text-brand-dark ml-1" fill="currentColor" viewBox="0 0 24 24">
                          <path d="M8 5v14l11-7z"/>
                        </svg>
                      </div>
                    </div>
                  </div>
                  <div class="p-6">
                    <h3 class="text-lg font-bold text-brand-dark font-georgia mb-2">
                      {lang === 'en' ? "A Journey of Self-Discovery" : "Un Viaje de Autodescubrimiento"}
                    </h3>
                    <p class="text-gray-600 font-gotham text-sm">
                      {lang === 'en' 
                        ? "Carlos Mendoza about his personal healing process"
                        : "Carlos Mendoza sobre su proceso de sanación personal"
                      }
                    </p>
                  </div>
                </div>
              </div>

              <div class="video-slide flex-shrink-0 w-full md:w-1/2 lg:w-1/3 px-3">
                <div class="bg-white rounded-xl shadow-lg overflow-hidden group cursor-pointer video-thumbnail" 
                     data-video-id="GtL1huin9EE" 
                     data-title={lang === 'en' ? "Sacred Ceremony - Ana Rodríguez" : "Ceremonia Sagrada - Ana Rodríguez"}>
                  <div class="relative">
                    <img 
                      src="https://img.youtube.com/vi/GtL1huin9EE/maxresdefault.jpg" 
                      alt={lang === 'en' ? "Testimony of Ana Rodríguez" : "Testimonio de Ana Rodríguez"} 
                      class="w-full h-48 object-cover group-hover:scale-105 transition-transform duration-300"
                    >
                    <div class="absolute inset-0 transition-all duration-300 flex items-center justify-center">
                      <div class="w-16 h-16 bg-white bg-opacity-90 rounded-full flex items-center justify-center group-hover:scale-110 transition-transform duration-300">
                        <svg class="w-6 h-6 text-brand-dark ml-1" fill="currentColor" viewBox="0 0 24 24">
                          <path d="M8 5v14l11-7z"/>
                        </svg>
                      </div>
                    </div>
                  </div>
                  <div class="p-6">
                    <h3 class="text-lg font-bold text-brand-dark font-georgia mb-2">
                      {lang === 'en' ? "Sacred Ceremony" : "Ceremonia Sagrada"}
                    </h3>
                    <p class="text-gray-600 font-gotham text-sm">
                      {lang === 'en' 
                        ? "Ana Rodríguez reflects on the ayahuasca ceremony"
                        : "Ana Rodríguez reflexiona sobre la ceremonia de ayahuasca"
                      }
                    </p>
                  </div>
                </div>
              </div>

              <div class="video-slide flex-shrink-0 w-full md:w-1/2 lg:w-1/3 px-3">
                <div class="bg-white rounded-xl shadow-lg overflow-hidden group cursor-pointer video-thumbnail" 
                     data-video-id="jNQXAC9IVRw" 
                     data-title={lang === 'en' ? "Deep Healing - Luis Torres" : "Sanación Profunda - Luis Torres"}>
                  <div class="relative">
                    <img 
                      src="https://img.youtube.com/vi/jNQXAC9IVRw/maxresdefault.jpg" 
                      alt={lang === 'en' ? "Testimony of Luis Torres" : "Testimonio de Luis Torres"} 
                      class="w-full h-48 object-cover group-hover:scale-105 transition-transform duration-300"
                    >
                    <div class="absolute inset-0 transition-all duration-300 flex items-center justify-center">
                      <div class="w-16 h-16 bg-white bg-opacity-90 rounded-full flex items-center justify-center group-hover:scale-110 transition-transform duration-300">
                        <svg class="w-6 h-6 text-brand-dark ml-1" fill="currentColor" viewBox="0 0 24 24">
                          <path d="M8 5v14l11-7z"/>
                        </svg>
                      </div>
                    </div>
                  </div>
                  <div class="p-6">
                    <h3 class="text-lg font-bold text-brand-dark font-georgia mb-2">
                      {lang === 'en' ? "Deep Healing" : "Sanación Profunda"}
                    </h3>
                    <p class="text-gray-600 font-gotham text-sm">
                      {lang === 'en' 
                        ? "Luis Torres about his emotional healing process"
                        : "Luis Torres sobre su proceso de sanación emocional"
                      }
                    </p>
                  </div>
                </div>
              </div>

              <div class="video-slide flex-shrink-0 w-full md:w-1/2 lg:w-1/3 px-3">
                <div class="bg-white rounded-xl shadow-lg overflow-hidden group cursor-pointer video-thumbnail" 
                     data-video-id="dQw4w9WgXcQ" 
                     data-title={lang === 'en' ? "Transformational Experience - María González" : "Experiencia Transformadora - María González"}>
                  <div class="relative">
                    <img 
                      src="https://img.youtube.com/vi/dQw4w9WgXcQ/maxresdefault.jpg" 
                      alt={lang === 'en' ? "Testimony of María González" : "Testimonio de María González"} 
                      class="w-full h-48 object-cover group-hover:scale-105 transition-transform duration-300"
                    >
                    <div class="absolute inset-0 transition-all duration-300 flex items-center justify-center">
                      <div class="w-16 h-16 bg-white bg-opacity-90 rounded-full flex items-center justify-center group-hover:scale-110 transition-transform duration-300">
                        <svg class="w-6 h-6 text-brand-dark ml-1" fill="currentColor" viewBox="0 0 24 24">
                          <path d="M8 5v14l11-7z"/>
                        </svg>
                      </div>
                    </div>
                  </div>
                  <div class="p-6">
                    <h3 class="text-lg font-bold text-brand-dark font-georgia mb-2">
                      {lang === 'en' ? "Transformational Experience" : "Experiencia Transformadora"}
                    </h3>
                    <p class="text-gray-600 font-gotham text-sm">
                      {lang === 'en' 
                        ? "María González shares her healing experience at Casa del Jaguar"
                        : "María González comparte su experiencia de sanación en Casa del Jaguar"
                      }
                    </p>
                  </div>
                </div>
              </div>

              <div class="video-slide flex-shrink-0 w-full md:w-1/2 lg:w-1/3 px-3">
                <div class="bg-white rounded-xl shadow-lg overflow-hidden group cursor-pointer video-thumbnail" 
                     data-video-id="9bZkp7q19f0" 
                     data-title={lang === 'en' ? "A Journey of Self-Discovery - Carlos Mendoza" : "Un Viaje de Autodescubrimiento - Carlos Mendoza"}>
                  <div class="relative">
                    <img 
                      src="https://img.youtube.com/vi/9bZkp7q19f0/maxresdefault.jpg" 
                      alt={lang === 'en' ? "Testimony of Carlos Mendoza" : "Testimonio de Carlos Mendoza"} 
                      class="w-full h-48 object-cover group-hover:scale-105 transition-transform duration-300"
                    >
                    <div class="absolute inset-0 transition-all duration-300 flex items-center justify-center">
                      <div class="w-16 h-16 bg-white bg-opacity-90 rounded-full flex items-center justify-center group-hover:scale-110 transition-transform duration-300">
                        <svg class="w-6 h-6 text-brand-dark ml-1" fill="currentColor" viewBox="0 0 24 24">
                          <path d="M8 5v14l11-7z"/>
                        </svg>
                      </div>
                    </div>
                  </div>
                  <div class="p-6">
                    <h3 class="text-lg font-bold text-brand-dark font-georgia mb-2">
                      {lang === 'en' ? "A Journey of Self-Discovery" : "Un Viaje de Autodescubrimiento"}
                    </h3>
                    <p class="text-gray-600 font-gotham text-sm">
                      {lang === 'en' 
                        ? "Carlos Mendoza about his personal healing process"
                        : "Carlos Mendoza sobre su proceso de sanación personal"
                      }
                    </p>
                  </div>
                </div>
              </div>

              <div class="video-slide flex-shrink-0 w-full md:w-1/2 lg:w-1/3 px-3">
                <div class="bg-white rounded-xl shadow-lg overflow-hidden group cursor-pointer video-thumbnail" 
                     data-video-id="GtL1huin9EE" 
                     data-title={lang === 'en' ? "Sacred Ceremony - Ana Rodríguez" : "Ceremonia Sagrada - Ana Rodríguez"}>
                  <div class="relative">
                    <img 
                      src="https://img.youtube.com/vi/GtL1huin9EE/maxresdefault.jpg" 
                      alt={lang === 'en' ? "Testimony of Ana Rodríguez" : "Testimonio de Ana Rodríguez"} 
                      class="w-full h-48 object-cover group-hover:scale-105 transition-transform duration-300"
                    >
                    <div class="absolute inset-0 transition-all duration-300 flex items-center justify-center">
                      <div class="w-16 h-16 bg-white bg-opacity-90 rounded-full flex items-center justify-center group-hover:scale-110 transition-transform duration-300">
                        <svg class="w-6 h-6 text-brand-dark ml-1" fill="currentColor" viewBox="0 0 24 24">
                          <path d="M8 5v14l11-7z"/>
                        </svg>
                      </div>
                    </div>
                  </div>
                  <div class="p-6">
                    <h3 class="text-lg font-bold text-brand-dark font-georgia mb-2">
                      {lang === 'en' ? "Sacred Ceremony" : "Ceremonia Sagrada"}
                    </h3>
                    <p class="text-gray-600 font-gotham text-sm">
                      {lang === 'en' 
                        ? "Ana Rodríguez reflects on the ayahuasca ceremony"
                        : "Ana Rodríguez reflexiona sobre la ceremonia de ayahuasca"
                      }
                    </p>
                  </div>
                </div>
              </div>

              <div class="video-slide flex-shrink-0 w-full md:w-1/2 lg:w-1/3 px-3">
                <div class="bg-white rounded-xl shadow-lg overflow-hidden group cursor-pointer video-thumbnail" 
                     data-video-id="jNQXAC9IVRw" 
                     data-title={lang === 'en' ? "Deep Healing - Luis Torres" : "Sanación Profunda - Luis Torres"}>
                  <div class="relative">
                    <img 
                      src="https://img.youtube.com/vi/jNQXAC9IVRw/maxresdefault.jpg" 
                      alt={lang === 'en' ? "Testimony of Luis Torres" : "Testimonio de Luis Torres"} 
                      class="w-full h-48 object-cover group-hover:scale-105 transition-transform duration-300"
                    >
                    <div class="absolute inset-0 transition-all duration-300 flex items-center justify-center">
                      <div class="w-16 h-16 bg-white bg-opacity-90 rounded-full flex items-center justify-center group-hover:scale-110 transition-transform duration-300">
                        <svg class="w-6 h-6 text-brand-dark ml-1" fill="currentColor" viewBox="0 0 24 24">
                          <path d="M8 5v14l11-7z"/>
                        </svg>
                      </div>
                    </div>
                  </div>
                  <div class="p-6">
                    <h3 class="text-lg font-bold text-brand-dark font-georgia mb-2">
                      {lang === 'en' ? "Deep Healing" : "Sanación Profunda"}
                    </h3>
                    <p class="text-gray-600 font-gotham text-sm">
                      {lang === 'en' 
                        ? "Luis Torres about his emotional healing process"
                        : "Luis Torres sobre su proceso de sanación emocional"
                      }
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <button 
            class="video-prev absolute left-0 top-1/2 transform -translate-y-1/2 -translate-x-4 w-12 h-12 bg-white shadow-lg rounded-full flex items-center justify-center hover:bg-gray-50 transition-colors z-10"
            aria-label={lang === 'en' ? "Previous video" : "Video anterior"}
          >
            <svg class="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
            </svg>
          </button>
          <button 
            class="video-next absolute right-0 top-1/2 transform -translate-y-1/2 translate-x-4 w-12 h-12 bg-white shadow-lg rounded-full flex items-center justify-center hover:bg-gray-50 transition-colors z-10"
            aria-label={lang === 'en' ? "Next video" : "Siguiente video"}
          >
            <svg class="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
            </svg>
          </button>
        </div>
      </div>
    </section>

    <div id="videoModal" class="fixed inset-0 bg-black bg-opacity-80 z-50 hidden">
      <div class="absolute inset-0 flex items-center justify-center p-4">
        <div class="relative w-full max-w-4xl">
          <button 
            id="closeModal" 
            class="absolute -top-12 right-0 text-white hover:text-gray-300 text-2xl z-10"
            aria-label={lang === 'en' ? "Close video modal" : "Cerrar modal de video"}
          >
            ✕
          </button>
          <div id="videoContainer" class="relative bg-black rounded-lg overflow-hidden" style="padding-bottom: 56.25%; height: 0;">
          </div>
        </div>
      </div>
    </div>

</Layout>

<script define:vars={{ lang }}>
document.addEventListener('DOMContentLoaded', function() {
  const form = document.getElementById('pricingForm');
  const submitButton = document.getElementById('submitButton');
  const successMessage = document.getElementById('successMessage');

  if (!form || !submitButton || !successMessage) return;

  const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

  const errorMessages = {
    required: lang === 'en' ? 'This field is required' : 'Este campo es requerido',
    email: lang === 'en' ? 'Please enter a valid email' : 'Por favor ingresa un email válido',
    country: lang === 'en' ? 'Please select your country' : 'Por favor selecciona tu país'
  };

  const loadingText = lang === 'en' ? 'Submitting...' : 'Enviando...';
  const submitText = lang === 'en' ? 'Submit Request' : 'Enviar Solicitud';
  const errorAlert = lang === 'en' 
    ? 'There was an error submitting the form. Please try again.'
    : 'Hubo un error al enviar el formulario. Por favor inténtalo de nuevo.';

  function showError(field, message) {
    const errorElement = field.parentElement?.querySelector('.error-message');
    if (errorElement) {
      errorElement.textContent = message;
      errorElement.classList.remove('hidden');
    }
    field.classList.add('border-red-500');
  }

  function hideError(field) {
    const errorElement = field.parentElement?.querySelector('.error-message');
    if (errorElement) {
      errorElement.classList.add('hidden');
    }
    field.classList.remove('border-red-500');
  }

  function validateField(field) {
    const value = field.value.trim();
    
    if (field.hasAttribute('required') && !value) {
      showError(field, errorMessages.required);
      return false;
    }

    if (field.type === 'email' && value && !emailPattern.test(value)) {
      showError(field, errorMessages.email);
      return false;
    }

    hideError(field);
    return true;
  }

  const fields = form.querySelectorAll('input, select');
  fields.forEach(field => {
    field.addEventListener('blur', () => validateField(field));
    field.addEventListener('input', () => {
      if (field.classList.contains('border-red-500')) {
        validateField(field);
      }
    });
  });

  form.addEventListener('submit', async function(e) {
    e.preventDefault();

    let isValid = true;
    fields.forEach(field => {
      if (!validateField(field)) {
        isValid = false;
      }
    });

    if (!isValid) return;

    submitButton.disabled = true;
    submitButton.textContent = loadingText;

    try {
      await new Promise(resolve => setTimeout(resolve, 1500));
      
      form.classList.add('hidden');
      successMessage.classList.remove('hidden');
      
      successMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
      
    } catch (error) {
      console.error('Error submitting form:', error);
      alert(errorAlert);
    } finally {
      submitButton.disabled = false;
      submitButton.textContent = submitText;
    }
  });

  form.addEventListener('keydown', function(e) {
    if (e.key === 'Enter' && e.target !== submitButton) {
      e.preventDefault();
      submitButton.click();
    }
  });
});
</script>

<style>
  .video-thumbnail {
    height: 320px;
    display: flex;
    flex-direction: column;
  }
  
  .video-thumbnail .relative {
    flex-shrink: 0;
  }
  
  .video-thumbnail .p-6 {
    flex: 1;
    display: flex;
    flex-direction: column;
  }
  
  .video-thumbnail .p-6 p {
    flex: 1;
  }
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const observerOptions = {
    threshold: 0.1,
    rootMargin: '0px 0px -50px 0px'
  };

  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add('visible');
      }
    });
  }, observerOptions);

  const animatedElements = document.querySelectorAll('.scroll-animate');
  animatedElements.forEach(el => observer.observe(el));

  // Video Slider Functionality
  let currentSlide = 0;
  const videoTrack = document.querySelector('.video-track') as HTMLElement;
  const videoSlides = document.querySelectorAll('.video-slide');
  const prevButton = document.querySelector('.video-prev') as HTMLElement;
  const nextButton = document.querySelector('.video-next') as HTMLElement;
  const dots = document.querySelectorAll('.video-dot');
  const modal = document.getElementById('videoModal') as HTMLElement;
  const videoContainer = document.getElementById('videoContainer') as HTMLElement;
  const closeModalBtn = document.getElementById('closeModal') as HTMLElement;

  const slidesPerView = getSlidesPerView();
  const uniqueVideos = 4; // Only 4 unique videos
  const totalSlides = 8; // 8 total elements (4 original + 4 duplicates)
  let isAnimating = false;

  function getSlidesPerView() {
    if (window.innerWidth >= 1024) return 3; // lg
    if (window.innerWidth >= 768) return 2;  // md
    return 1; // mobile
  }

  function updateSlider(transition = true) {
    if (!videoTrack) return;
    
    const slideWidth = 100 / slidesPerView;
    const translateX = -(currentSlide * slideWidth);
    
    videoTrack.style.transition = transition ? 'transform 0.5s ease-in-out' : 'none';
    videoTrack.style.transform = `translateX(${translateX}%)`;

    // Update dots based on current video (mod 4 for the 4 unique videos)
    const visualIndex = currentSlide % uniqueVideos;
    const visibleGroupIndex = Math.floor(visualIndex / slidesPerView);
    dots.forEach((dot, index) => {
      dot.classList.toggle('bg-brand-primary', index === visibleGroupIndex);
      dot.classList.toggle('bg-gray-300', index !== visibleGroupIndex);
    });
  }

  function nextSlide() {
    if (isAnimating) return;
    isAnimating = true;
    
    currentSlide++;
    updateSlider(true);
    
    // If we've moved past the first set of 4, reset to beginning seamlessly
    if (currentSlide >= uniqueVideos) {
      setTimeout(() => {
        currentSlide = 0;
        updateSlider(false);
        setTimeout(() => {
          isAnimating = false;
        }, 50);
      }, 500);
    } else {
      setTimeout(() => {
        isAnimating = false;
      }, 500);
    }
  }

  function prevSlide() {
    if (isAnimating) return;
    isAnimating = true;
    
    // If we're at the beginning, jump to the duplicate set first
    if (currentSlide <= 0) {
      currentSlide = uniqueVideos; // Jump to video 5 (duplicate of video 1)
      updateSlider(false);
      setTimeout(() => {
        currentSlide = uniqueVideos - 1; // Move to video 4 (duplicate)
        updateSlider(true);
        setTimeout(() => {
          isAnimating = false;
        }, 500);
      }, 50);
    } else {
      currentSlide--;
      updateSlider(true);
      setTimeout(() => {
        isAnimating = false;
      }, 500);
    }
  }

  // Event listeners for navigation
  if (nextButton) nextButton.addEventListener('click', nextSlide);
  if (prevButton) prevButton.addEventListener('click', prevSlide);

  // Dot navigation - jump to specific video
  dots.forEach((dot, index) => {
    dot.addEventListener('click', () => {
      if (isAnimating) return;
      isAnimating = true;
      
      currentSlide = index;
      updateSlider(true);
      
      setTimeout(() => {
        isAnimating = false;
      }, 500);
    });
  });

  // Video modal functionality
  const videoThumbnails = document.querySelectorAll('.video-thumbnail');
  
  videoThumbnails.forEach(thumbnail => {
    thumbnail.addEventListener('click', () => {
      const videoId = thumbnail.getAttribute('data-video-id');
      const title = thumbnail.getAttribute('data-title');
      
      if (videoId && modal && videoContainer) {
        // Create lite-youtube element
        const liteYoutube = document.createElement('lite-youtube');
        liteYoutube.setAttribute('videoid', videoId);
        liteYoutube.setAttribute('style', 'position: absolute; top: 0; left: 0; width: 100%; height: 100%;');
        
        // Clear previous content and add new video
        videoContainer.innerHTML = '';
        videoContainer.appendChild(liteYoutube);
        
        // Show modal
        modal.classList.remove('hidden');
        modal.style.display = 'block';
        document.body.style.overflow = 'hidden';
      }
    });
  });

  // Close modal functionality
  function closeModal() {
    if (modal && videoContainer) {
      modal.classList.add('hidden');
      modal.style.display = 'none';
      document.body.style.overflow = 'auto';
      
      // Clear video content to stop playback
      setTimeout(() => {
        videoContainer.innerHTML = '';
      }, 300);
    }
  }

  if (closeModalBtn) closeModalBtn.addEventListener('click', closeModal);
  
  // Close modal when clicking outside
  if (modal) {
    modal.addEventListener('click', (e) => {
      if (e.target === modal) {
        closeModal();
      }
    });
  }

  // Close modal with Escape key
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      closeModal();
    }
  });

  // Update slider on window resize
  window.addEventListener('resize', () => {
    const newSlidesPerView = getSlidesPerView();
    updateSlider(false);
  });

  // Initialize slider
  updateSlider(false);
});
</script>

<!-- Lite YouTube CSS and JS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lite-youtube-embed@0.3.2/src/lite-yt-embed.css">
<script src="https://cdn.jsdelivr.net/npm/lite-youtube-embed@0.3.2/src/lite-yt-embed.js"></script>
